set-option -g default-terminal 'screen-256color'
set-option -g terminal-overrides ',xterm-256color:RGB'

unbind C-b
set -g prefix `
bind ` send-prefix
set -g mouse on
set -g base-index 1
set -g set-clipboard on          # use system clipboard
set -g status-position top       # macOS / darwin style
set -g detach-on-destroy off     # don't exit from tmux when closing a session
set -g escape-time 0             # zero-out escape time delay
set -g history-limit 1000000     # increase history size (from 2,000)
set -g renumber-windows on       # renumber all windows when any window is closed

bind r command-prompt "rename-window %%"
bind R source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# Better pane splitting (and keep current path)
bind | split-window -h -c "#{pane_current_path}"
bind _ split-window -v -c "#{pane_current_path}"

# Pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind w list-windows
bind x kill-pane

# Pane resizing
bind -r , resize-pane -L 15
bind -r . resize-pane -R 15
bind -r - resize-pane -D 5
bind -r = resize-pane -U 5
bind Z resize-pane -Z

# Window navigation
bind -r H previous-window
bind -r L next-window
bind c new-window -c "#{pane_current_path}"
bind X kill-window

# Copy mode vi bindings (screen-like behavior)
bind -T copy-mode-vi v send-keys -X begin-selection                    # v: begin selection
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel          # y: copy and exit
bind -T copy-mode-vi r send-keys -X rectangle-toggle                   # r: toggle rectangle mode
bind -T copy-mode-vi Escape send-keys -X cancel                        # Esc: exit copy mode
bind -T copy-mode-vi / send-keys -X search-forward                     # /: search forward
bind -T copy-mode-vi ? send-keys -X search-backward                    # ?: search backward
bind -T copy-mode-vi n send-keys -X search-again                       # n: next search result
bind -T copy-mode-vi N send-keys -X search-reverse                     # N: previous search result
bind -T copy-mode-vi h send-keys -X cursor-left                        # h: move left
bind -T copy-mode-vi j send-keys -X cursor-down                        # j: move down
bind -T copy-mode-vi k send-keys -X cursor-up                          # k: move up
bind -T copy-mode-vi l send-keys -X cursor-right                       # l: move right

# Source flexoki theme
source-file ~/.config/tmux/flexoki-dark.tmuxtheme

set -g pane-active-border-style 'fg=magenta,bg=default'
set -g pane-border-style 'fg=brightblack,bg=default'

# List of plugins
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin 'omerxx/tmux-floax'
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

set -g @floax-width '80%'
set -g @floax-height '80%'
set -g @floax-border-color 'magenta'
set -g @floax-text-color 'blue'
set -g @floax-bind 'p'
set -g @floax-change-path 'true'

# sessionx config
set -g @sessionx-bind 'o'
set -g @sessionx-window-height '80%'
set -g @sessionx-window-width '75%'
set -g @sessionx-zoxide-mode 'on'
set -g @sessionx-filter-current 'true'
set -g @sessionx-preview-location 'top'
set -g @sessionx-layout 'reverse'
set -g @sessionx-filtered-sessions 'scratch'
set -g @sessionx-pointer '>'
set -g @sessionx-additional-options '--color=bg+:#282726,bg:#1c1b1a,spinner:#cecdc3,hl:#d14d41,fg:#cecdc3,header:#d14d41,info:#8b7ec8,pointer:#cecdc3,marker:#cecdc3,fg+:#cecdc3,prompt:#8b7ec8,hl+:#d14d41'

# lazygit popup
bind g display-popup -E -w 95% -h 95% -d "#{pane_current_path}" "lazygit"
bind V display-popup -E -w 95% -h 95% -d "#{pane_current_path}" "nvim"

# Status line
set -g status-left "#[fg=#cecdc3,bold] ô€£º  #S "
set -g status-right "#[fg=#878580] #{pane_current_path} "

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.config/tmux/plugins/tpm/tpm'
